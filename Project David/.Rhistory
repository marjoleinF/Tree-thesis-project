library("haven")
library("dbarts")
library("glmertree")
library("dplyr")
library("here")
library("multilevel")
# library("mice")
gendata_bay <- function(data, PPD, n_gen){
if(nrow(data) != ncol(PPD)){stop("Amount of observations in PPD is different from data")}
index_gen <- sample.int(n = nrow(data), size = n_gen, replace = TRUE)
x_gen <- data[index_gen,]
y_gen <- sapply(index_gen, function(i) sample(x = PPD[,i], size = 1))
# y_gen <- sapply(index_gen, function(i) sample(x = PPD[,i][PPD[,i] >= quantile(PPD[,i], probs = .40) & PPD[,i] <= quantile(PPD[,i], probs = .60)], size = 1))
return(cbind(x_gen, y_gen))
}
gendata_smr <- function(data, palt = 0.5, n_gen){
if(palt < 0 | palt > 1){stop("palt must be bound between between 0 and 1")}
index_gen <- sample.int(n = nrow(data), size = n_gen, replace = TRUE)
gen_data <- data[index_gen,]
if(palt != 0){
for(i in 1:nrow(gen_data)){
for(j in 1:ncol(gen_data)){
if(runif(1) <= palt){gen_data[i,j] <- sample(x = data[,j], size = 1)}
}
}
}
return(gen_data)
}
data = read_sav(file.path(here(), "Safety.sav"))
data <- read_sav("D:/Users/david/Documents/GitHub/Tree-thesis-project/Safety.sav")
ls()
getwd()
getwd()
here()
